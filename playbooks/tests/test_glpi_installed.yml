---
- name: Test GLPI installation
  hosts: glpi
  become: true
  gather_facts: false
  tasks:
    - name: Check GLPI directory exists
      ansible.builtin.stat:
        path: /var/www/html/glpi
      register: glpi_dir

    - name: Assert GLPI directory exists
      ansible.builtin.assert:
        that:
          - glpi_dir.stat.exists
          - glpi_dir.stat.isdir

    - name: Check GLPI config file exists
      ansible.builtin.stat:
        path: /var/www/html/glpi/config/config_db.php
      register: glpi_config

    - name: Assert GLPI config file exists
      ansible.builtin.assert:
        that:
          - glpi_config.stat.exists
          - glpi_config.stat.isreg

    - name: Check GLPI version.php exists
      ansible.builtin.stat:
        path: /var/www/html/glpi/version.php
      register: glpi_version

    - name: Assert GLPI version.php exists
      ansible.builtin.assert:
        that:
          - glpi_version.stat.exists
          - glpi_version.stat.isreg
